<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æœ¨è–¯å”å¤©ç„¶æœ¨è–¯è²“ç ‚</title>

  <!-- Snipcart CSS -->
  <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.3.0/default/snipcart.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main>
    <h2>ç”¢å“ä»‹ç´¹</h2>
    <div class="product">
      <h3>æœ¨è–¯å”å¤©ç„¶æœ¨è–¯è²“ç ‚</h3>
      <p>å¤©ç„¶ç„¡æ·»åŠ æœ¨è–¯è²“ç ‚ï¼Œæ¸…çˆ½ä¸é»åº•ï¼Œé©åˆéæ•è²“</p>

      <div class="quantity-container">
        <button class="quantity-button" onclick="decreaseQuantity()">âˆ’</button>
        <input id="product-quantity" type="number" value="1" min="1" />
        <button class="quantity-button" onclick="increaseQuantity()">ï¼‹</button>
      </div>

      <button
        class="snipcart-add-item custom-cart-button"
        data-item-id="cassava-sand"
        data-item-name="æœ¨è–¯å”å¤©ç„¶æœ¨è–¯è²“ç ‚"
        data-item-price="250"
        data-item-url="index.html"
        data-item-description="å¤©ç„¶ç„¡æ·»åŠ æœ¨è–¯è²“ç ‚ï¼Œæ¸…çˆ½ä¸é»åº•ï¼Œé©åˆéæ•è²“"
        data-item-quantity="1"
        onclick="updateQuantity()"
      >
        åŠ å…¥è³¼ç‰©è»Š
      </button>
    </div>
  </main>

  <!-- æµ®å‹•è³¼ç‰©æ¬„ HTML -->
  <div class="floating-cart-bar" id="floatingCartBar">
    <a href="#" class="snipcart-checkout">
      ğŸ›’ è³¼ç‰©è»Šï¼š<span class="snipcart-items-count"></span> ä»¶ â€“ NT$<span class="snipcart-total-price"></span>
    </a>
  </div>

  <!-- Snipcart Script -->
  <script async src="https://cdn.snipcart.com/themes/v3.3.0/default/snipcart.js"></script>

  <!-- Snipcart Container -->
  <div hidden id="snipcart" data-api-key="MDJhYTU3MzEtM2U3Ni00NmNiLTgzODUtYWEzNTI1MmFmYjVmNjM4ODQ0Njc2MTc2MzY4ODA5"></div>

  <!-- åŠŸèƒ½è…³æœ¬ -->
  <script>
    function increaseQuantity() {
      const input = document.getElementById("product-quantity");
      input.value = parseInt(input.value) + 1;
    }

    function decreaseQuantity() {
      const input = document.getElementById("product-quantity");
      if (parseInt(input.value) > 1) {
        input.value = parseInt(input.value) - 1;
      }
    }

    function updateQuantity() {
      const quantity = document.getElementById("product-quantity").value;
      const button = document.querySelector(".snipcart-add-item");
      button.setAttribute("data-item-quantity", quantity);
    }

    // æµ®å‹•æ¬„ä½å‡ºç¾/æ¶ˆå¤±åŠŸèƒ½
    let lastScrollY = window.scrollY;
    const cartBar = document.getElementById("floatingCartBar");

    window.addEventListener("scroll", () => {
      const currentScrollY = window.scrollY;

      if (currentScrollY > lastScrollY) {
        cartBar.classList.add("show");
      } else {
        cartBar.classList.remove("show");
      }

      lastScrollY = currentScrollY;
    });

    // åŒæ­¥è³¼ç‰©è»Šæ•¸é‡èˆ‡é‡‘é¡
    document.addEventListener('snipcart.ready', () => {
      const cartCount = document.querySelector('.snipcart-items-count');
      const cartTotal = document.querySelector('.snipcart-total-price');

      Snipcart.store.subscribe(() => {
        const state = Snipcart.store.getState();
        const items = state.cart.items;
        const total = state.cart.total;

        const quantity = items.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = quantity;
        cartTotal.textContent = Math.round(total);
      });
    });
  </script>
</body>
</html>
